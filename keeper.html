<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keeper Scout - Potter's Old Boys</title>
    
    <link rel="apple-touch-icon" href="potters.jpg">
    <link rel="icon" href="potters.jpg">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#3D7C3B">
    <meta name="mobile-web-app-capable" content="yes">

    <style>
        :root {
            --ht-green: #3D7C3B;
            --ht-yellow: #FFC200;
            --ht-bg: #F0F4F0;
            --ht-text: #333333;
            --white: #ffffff;
        }

        body {
            font-family: Verdana, 'Segoe UI', sans-serif;
            background-color: var(--ht-bg);
            color: var(--ht-text);
            margin: 0;
            padding: 15px;
            display: flex;
            justify-content: center;
        }

        .app-container {
            width: 100%;
            max-width: 450px;
            background-color: var(--white);
            border-radius: 8px;
            border-top: 4px solid var(--ht-green);
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
        }

        .header { 
            text-align: center; 
            margin-bottom: 20px; 
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .ht-logo { width: 150px; height: auto; }
        .pob-logo { width: 70px; height: auto; }

        h1 { 
            color: var(--ht-green); 
            font-size: 1.3em; 
            margin: 0; 
            text-transform: uppercase; 
            font-weight: bold;
        }

        /* CHARACTER DISPLAY STYLE */
        .character-display {
            margin-top: 0;
            margin-bottom: 25px;
            padding-top: 0;
            border-top: none;
            display: flex;
            align-items: flex-start;
        }

        .footer-photo {
            width: 80px;
            height: auto;
            margin-right: 15px;
        }

        .quote-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .quote-box {
            font-style: italic;
            color: #555;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 8px;
            border-left: 4px solid var(--ht-yellow);
            font-size: 0.9em;
            position: relative;
        }

        .name-tag {
            font-weight: bold;
            color: var(--ht-green);
            font-style: normal;
            display: inline-block;
            margin-bottom: 5px;
            font-size: 0.95em;
        }

        .info-btn {
            background-color: var(--ht-green);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: inline-block;
            text-align: center;
            line-height: 18px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            margin-left: 5px;
            font-style: normal;
            vertical-align: middle;
            border: none;
        }

        .input-group { margin-bottom: 15px; }
        label { 
            display: block; 
            font-size: 0.9em; 
            margin-bottom: 5px; 
            color: var(--ht-green); 
            font-weight: bold; 
        }

        select, input[type="number"] {
            width: 100%;
            padding: 12px;
            border-radius: 5px;
            border: 1px solid #ccc;
            background-color: #fcfcfc;
            color: var(--ht-text);
            font-size: 16px;
            outline: none;
            box-sizing: border-box;
            -moz-appearance: textfield;
        }

        .row-2 {
            display: flex;
            gap: 10px;
        }
        .row-2 div { flex: 1; }

        .results-container {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }
        
        .result-box {
            flex: 1;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .main-box { background-color: var(--ht-green); color: var(--white); }
        .sub-box { background-color: var(--ht-yellow); color: var(--ht-text); border: 1px solid #e0a800; }

        .label-small { font-size: 0.75em; text-transform: uppercase; font-weight: bold; opacity: 0.9; margin-bottom: 5px; }
        .val-large { font-size: 2em; font-weight: bold; margin: 0; line-height: 1.2; }
        .val-detail { font-size: 0.9em; margin-top: 5px; }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .modal-content {
            background-color: var(--white);
            padding: 20px;
            border-radius: 8px;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            font-size: 0.85em;
            line-height: 1.5;
        }

        .modal-header {
            color: var(--ht-green);
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }

        .close-btn {
            background: var(--ht-green);
            color: white;
            border: none;
            padding: 10px;
            width: 100%;
            border-radius: 5px;
            margin-top: 15px;
            cursor: pointer;
            font-weight: bold;
        }

        .formula-box {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9em;
            margin-bottom: 10px;
            border-left: 4px solid var(--ht-yellow);
            color: #333;
        }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">
        <div class="logo-container">
            <img src="logo.png" alt="Hattrick Logo" class="ht-logo">
            <img src="potters.jpg" alt="Potter's Old Boys Logo" class="pob-logo">
        </div>
        <h1>Keeper Scout</h1>
    </div>

    <div class="character-display">
        <img src="davey.jpg" alt="Davey Vader" class="footer-photo">
        <div class="quote-wrapper">
            <div class="quote-box">
                <div>
                    <span class="name-tag">Davey Vader:</span>
                    <button class="info-btn" onclick="openModal()">i</button>
                </div>
                "Ik vind je gebrek aan keeperskwaliteiten... stuitend."
            </div>
        </div>
    </div>

    <div class="input-group">
        <label>Salaris (€)</label>
        <div style="font-size:0.75em; color:#666; margin-bottom:5px;">Basissalaris (zonder 20% buitenland bonus).</div>
        <input type="number" id="salaris" placeholder="Bijv. 3500" oninput="berekenKeeper()">
    </div>

    <div class="input-group">
        <label>TSI (Total Skill Index)</label>
        <input type="number" id="tsi" placeholder="Bijv. 2100" oninput="berekenKeeper()">
    </div>

    <div class="input-group">
        <label>Leeftijd (Jaren)</label>
        <input type="number" id="leeftijdJaren" placeholder="Bijv. 17" value="17" oninput="berekenKeeper()">
    </div>

    <div class="input-group">
        <div class="row-2">
            <div>
                <label>Vorm</label>
                <select id="vorm" onchange="berekenKeeper()">
                    <option value="1">1. Rampzalig</option>
                    <option value="2">2. Slecht</option>
                    <option value="3">3. Waardeloos</option>
                    <option value="4">4. Zwak</option>
                    <option value="5">5. Matig</option>
                    <option value="6" selected>6. Redelijk</option>
                    <option value="7">7. Goed</option>
                    <option value="8">8. Uitstekend</option>
                </select>
            </div>
            <div>
                <label>Conditie</label>
                <select id="conditie" onchange="berekenKeeper()">
                    <option value="1">1. Rampzalig</option>
                    <option value="2">2. Slecht</option>
                    <option value="3">3. Waardeloos</option>
                    <option value="4">4. Zwak</option>
                    <option value="5" selected>5. Matig</option>
                    <option value="6">6. Redelijk</option>
                    <option value="7">7. Goed</option>
                    <option value="8">8. Uitstekend</option>
                    <option value="9">9. Formidabel</option>
                </select>
            </div>
        </div>
    </div>

    <div class="results-container">
        <div class="result-box main-box">
            <div class="label-small">Geschat Niveau</div>
            <div class="val-large" id="resLevel">0.00</div>
            <div style="font-size: 0.8em; margin-top:5px;" id="resNaam">Onbekend</div>
        </div>

        <div class="result-box sub-box">
            <div class="label-small">Analyse</div>
            <div class="val-detail" style="margin-top:10px;">Sal Skill: <span id="debugSal" style="font-weight:bold">-</span></div>
            <div class="val-detail">TSI Skill: <span id="debugTsi" style="font-weight:bold">-</span></div>
        </div>
    </div>

</div>

<div id="infoModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">Davey's Scout Methode (v2.4)</div>
        
        <p><strong>1. De "Floor" Regel</strong><br>
        Hattrick rondt niet af naar boven. Een skill van 7.9 is in het spel nog steeds 7 (Goed). Davey rondt daarom veilig af naar beneden.</p>

        <p><strong>2. Salaris Check</strong><br>
        Salarissen stijgen exponentieel. Bij talenten (17 t/m 21 jaar) is het salaris vaak kunstmatig laag, dus pas ik een correctie toe.</p>
        
        <p><strong>3. TSI Check</strong><br>
        Ik haal eerst de invloed van Vorm en Conditie uit de TSI. Daarna gebruik ik deze formule:</p>
        <div class="formula-box">Skill ≈ (Kale TSI / 4) ^ (1 / 3.3)</div>

        <p><strong>4. De Weging (Jonkies vs Oudere garde)</strong><br>
        Bij <strong>jonkies (17 t/m 21 jaar)</strong> vertrouw ik de TSI voor 70%. Bij de oudere garde (22+) is het salaris betrouwbaarder (60% weging).</p>

        <button class="close-btn" onclick="closeModal()">Begrepen</button>
    </div>
</div>

<script>
    // HATTRICK NIVEAUS
    const niveaus = [
        "Niet bestaand (0)", "Rampzalig (1)", "Slecht (2)", "Waardeloos (3)", 
        "Zwak (4)", "Matig (5)", "Redelijk (6)", "Goed (7)", 
        "Uitstekend (8)", "Formidabel (9)", "Uitmuntend (10)", "Briljant (11)", 
        "Wereldklasse (12)", "Buitenaards (13)", "Mythisch (14)", "Magisch (15)", 
        "Utopisch (16)", "Goddelijk (17)", "Goddelijk+1 (18)", "Goddelijk+2 (19)", "MAX (20)"
    ];

    function berekenKeeper() {
        // --- INPUTS ---
        let salaris = parseFloat(document.getElementById('salaris').value) || 0;
        let tsi = parseFloat(document.getElementById('tsi').value) || 0;
        let form = parseInt(document.getElementById('vorm').value);
        let stamina = parseInt(document.getElementById('conditie').value);
        let ageYears = parseInt(document.getElementById('leeftijdJaren').value) || 17;
        
        // --- CONSTANTEN ---
        const SALARIS_OFFSET = 250; 
        
        // --- STAP 1: SALARIS CHECK ---
        let skillSal = 0;
        if (salaris > SALARIS_OFFSET) {
            // Basis logaritme
            let rawSkill = Math.log(salaris / SALARIS_OFFSET) / Math.log(1.26);
            
            // LEEFTIJDSCORRECTIE (Voor Salaris curve)
            let ageCorrection = 0;
            if (ageYears < 19) {
                ageCorrection = 1.5; 
            } else if (ageYears < 21) {
                ageCorrection = 0.8; 
            } else if (ageYears > 28) {
                ageCorrection = -0.5; 
            }
            
            skillSal = rawSkill + ageCorrection;
        }

        // --- STAP 2: TSI CHECK ---
        const vormMap = {
            1: 0.15, 2: 0.30, 3: 0.48, 4: 0.68, 
            5: 1.00, 6: 1.45, 7: 2.15, 8: 3.20 
        };
        const condMap = {
            1: 0.60, 2: 0.70, 3: 0.80, 4: 0.90, 
            5: 0.95, 6: 1.00, 7: 1.03, 8: 1.05, 9: 1.06
        };

        let fVorm = vormMap[form] || 1.0;
        let fCond = condMap[stamina] || 1.0;

        let kaleTsi = tsi / (fVorm * fCond);
        
        let skillTsi = 0;
        if (kaleTsi > 10) {
             skillTsi = Math.pow(kaleTsi / 4, 1/3.3);
        }

        // --- STAP 3: FUSIE ---
        let finalSkill = 0;
        
        if (salaris > 0 && tsi > 0) {
            // AANGEPAST: Jonkies zijn nu 17 t/m 21 jaar
            if (ageYears <= 21) {
                // Jong = TSI leidend (70%)
                finalSkill = (skillSal * 0.3) + (skillTsi * 0.7);
            } else {
                // Oud = Salaris leidend (60%)
                finalSkill = (skillSal * 0.6) + (skillTsi * 0.4);
            }
        } else if (salaris > 0) {
            finalSkill = skillSal;
        } else if (tsi > 0) {
            finalSkill = skillTsi;
        }

        // --- OUTPUT ---
        if (finalSkill < 0) finalSkill = 0;

        let displaySkill = finalSkill.toFixed(2);
        let intSkill = Math.floor(finalSkill); 

        if (intSkill < 0) intSkill = 0;
        if (intSkill > 20) intSkill = 20;

        document.getElementById('resLevel').innerText = displaySkill;
        document.getElementById('resNaam').innerText = niveaus[intSkill];

        document.getElementById('debugSal').innerText = skillSal > 0 ? skillSal.toFixed(2) : "-";
        document.getElementById('debugTsi').innerText = skillTsi > 0 ? skillTsi.toFixed(2) : "-";
    }

    function openModal() { document.getElementById('infoModal').style.display = 'flex'; }
    function closeModal() { document.getElementById('infoModal').style.display = 'none'; }
    
    // Voer 1x uit bij laden
    window.onload = berekenKeeper;
</script>

</body>
</html>